<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste do Sistema de Analytics - Templats-Link</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        
        .success {
            background-color: #d4edda;
            border-color: #c3e6cb;
        }
        
        .error {
            background-color: #f8d7da;
            border-color: #f5c6cb;
        }
        
        .warning {
            background-color: #fff3cd;
            border-color: #ffeaa7;
        }
        
        button {
            padding: 10px 15px;
            margin: 5px;
            cursor: pointer;
        }
        
        form {
            margin: 10px 0;
        }
        
        input {
            margin: 5px;
            padding: 5px;
        }
    </style>
</head>

<body>
    <h1>üß™ Teste do Sistema de Analytics - Templats-Link</h1>

    <div class="test-section" id="status-section">
        <h3>üìä Status do Sistema</h3>
        <div id="status-content">Carregando...</div>
    </div>

    <div class="test-section">
        <h3>üß™ Testes Manuais</h3>
        <button onclick="testSendCustomEvent()">Testar sendCustomEvent()</button>
        <button onclick="testCheckStatus()">Verificar Status</button>
        <button onclick="testFormCapture()">Testar Captura de Formul√°rios</button>
        <button onclick="simulateSessionData()">Simular Dados da Sess√£o</button>
    </div>

    <div class="test-section">
        <h3>üìù Formul√°rio de Teste</h3>
        <form id="test-form" action="/contato" method="POST">
            <input type="text" name="nome" placeholder="Nome" required>
            <input type="email" name="email" placeholder="Email" required>
            <input type="tel" name="telefone" placeholder="Telefone">
            <button type="submit">Enviar Formul√°rio</button>
        </form>
    </div>

    <div class="test-section">
        <h3>üîó Bot√µes de Contato</h3>
        <a href="tel:+5511999999999" class="contact-button">üìû Ligar</a>
        <a href="mailto:teste@templats-link.com" class="contact-button">üìß Email</a>
    </div>

    <div class="test-section">
        <h3>üìã Logs do Console</h3>
        <div id="console-logs" style="background: #f8f9fa; padding: 10px; border-radius: 3px; max-height: 300px; overflow-y: auto;">
            <div>Logs aparecer√£o aqui...</div>
        </div>
    </div>

    <!-- Carregar scripts do sistema -->
    <script src="/js/analytics.js"></script>
    <script src="/js/test-analytics.js"></script>

    <script>
        // Interceptar console.log para mostrar na p√°gina
        const originalLog = console.log;
        const originalWarn = console.warn;
        const originalError = console.error;

        function addToLogs(message, type = 'log') {
            const logsDiv = document.getElementById('console-logs');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.innerHTML = `<strong>[${timestamp}]</strong> <span style="color: ${type === 'error' ? 'red' : type === 'warn' ? 'orange' : 'black'}">${message}</span>`;
            logsDiv.appendChild(logEntry);
            logsDiv.scrollTop = logsDiv.scrollHeight;
        }

        console.log = function(...args) {
            originalLog.apply(console, args);
            addToLogs(args.join(' '), 'log');
        };

        console.warn = function(...args) {
            originalWarn.apply(console, args);
            addToLogs(args.join(' '), 'warn');
        };

        console.error = function(...args) {
            originalError.apply(console, args);
            addToLogs(args.join(' '), 'error');
        };

        // Fun√ß√µes de teste
        function testSendCustomEvent() {
            console.log('üß™ Testando sendCustomEvent()...');

            if (typeof sendCustomEvent === 'function') {
                const testData = {
                    name: 'Jo√£o',
                    surname: 'Silva',
                    email: 'joao@teste.com',
                    phone: '+5511999999999',
                    country: 'Brasil',
                    cep: '01234-567',
                    region: 'S√£o Paulo',
                    city: 'S√£o Paulo',
                    street: 'Rua Teste, 123',
                    service: 'test',
                    source: 'test_page'
                };

                sendCustomEvent(testData);
                console.log('‚úÖ Evento de teste enviado');
            } else {
                console.error('‚ùå Fun√ß√£o sendCustomEvent n√£o encontrada');
            }
        }

        function testCheckStatus() {
            console.log('üß™ Verificando status do sistema...');

            if (typeof checkAnalyticsStatus === 'function') {
                const status = checkAnalyticsStatus();
                console.log('üìä Status:', status);
            } else {
                console.error('‚ùå Fun√ß√£o checkAnalyticsStatus n√£o encontrada');
            }
        }

        function testFormCapture() {
            console.log('üß™ Testando captura de formul√°rios...');

            const forms = document.querySelectorAll('form');
            console.log(`üìù Formul√°rios encontrados: ${forms.length}`);

            forms.forEach((form, index) => {
                console.log(`Formul√°rio ${index + 1}:`, {
                    action: form.action,
                    method: form.method,
                    hasName: form.querySelector('input[name="nome"], input[name="name"]') ? 'Sim' : 'N√£o',
                    hasEmail: form.querySelector('input[name="email"]') ? 'Sim' : 'N√£o',
                    hasPhone: form.querySelector('input[name="telefone"], input[name="phone"]') ? 'Sim' : 'N√£o'
                });
            });
        }

        function simulateSessionData() {
            console.log('üß™ Simulando dados da sess√£o...');

            if (typeof sendCustomEvent === 'function') {
                const mockData = {
                    name: 'Maria',
                    surname: 'Santos',
                    email: 'maria@teste.com',
                    phone: '+5511888888888',
                    country: 'Brasil',
                    cep: '04567-890',
                    region: 'Rio de Janeiro',
                    city: 'Rio de Janeiro',
                    street: 'Avenida Teste, 456',
                    service: 'contact',
                    source: 'footer_form'
                };

                sendCustomEvent(mockData);
                console.log('‚úÖ Dados simulados enviados');
            } else {
                console.error('‚ùå Fun√ß√£o sendCustomEvent n√£o encontrada');
            }
        }

        // Executar teste autom√°tico quando a p√°gina carregar
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ P√°gina de teste carregada');

            // Verificar status inicial
            setTimeout(() => {
                if (typeof testAnalyticsSystem === 'function') {
                    testAnalyticsSystem();
                } else {
                    console.warn('‚ö†Ô∏è Fun√ß√£o testAnalyticsSystem n√£o encontrada');
                }

                // Atualizar se√ß√£o de status
                updateStatusSection();
            }, 1000);
        });

        function updateStatusSection() {
            const statusDiv = document.getElementById('status-content');
            let status = '';

            if (typeof sendCustomEvent === 'function') {
                status += '<div class="success">‚úÖ Fun√ß√£o sendCustomEvent carregada</div>';
            } else {
                status += '<div class="error">‚ùå Fun√ß√£o sendCustomEvent n√£o encontrada</div>';
            }

            if (typeof checkAnalyticsStatus === 'function') {
                const systemStatus = checkAnalyticsStatus();
                status += `<div class="${systemStatus.gtm ? 'success' : 'warning'}">${systemStatus.gtm ? '‚úÖ' : '‚ö†Ô∏è'} GTM: ${systemStatus.gtm ? 'Dispon√≠vel' : 'N√£o encontrado'}</div>`;
                status += `<div class="${systemStatus.ga4 ? 'success' : 'warning'}">${systemStatus.ga4 ? '‚úÖ' : '‚ö†Ô∏è'} GA4: ${systemStatus.ga4 ? 'Dispon√≠vel' : 'N√£o encontrado'}</div>`;
            } else {
                status += '<div class="error">‚ùå Fun√ß√£o checkAnalyticsStatus n√£o encontrada</div>';
            }

            statusDiv.innerHTML = status;
        }
    </script>
</body>

</html>